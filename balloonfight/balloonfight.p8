pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
-- balloon fight
-- andrew stephens
-- july 2021
-- version 0.1

-- constants
ticks=0
left=-1
right=1
f_fg=0
f_bg=1
f_solid=2
f_enemy=3

-- physics/speeds constants
gravity=0.1
force=gravity*2
min_bounce=1
aspeed=0.1
aspeed_max=3
gspeed=0.1
gspeed_max=2

-- bounce
function bounce(vel)
	return max(-vel/2,min_bounce)
end

-- change game mode
function change_mode(mode_name)
	modes[mode_name]:init()
end

-- check for collisions
function collision(rect1,rect2)
	return rect1.x<rect2.x+rect2.width and
   rect1.x+rect1.width>rect2.x and
   rect1.y<rect2.y+rect2.height and
   rect1.y+rect1.height>rect2.y
end

-- lerp
function lerp(a, b, t)
	return a+(b-a)*t
end

-- pad with zeros
function pad(value,length)
	local string=tostr(value)
 if (#string==length) return string
 return "0"..pad(string, length-1)
end

-- print centered on x axis
function printc(text,y,x1,x2,c)
	x1=x1 or 0
	x2=x2 or 127
	c=c or 7
	local width=#text*4
	local x=(x2-x1)/2+x1-width/2
	print(text,x,y,c)
end

-- random direction
function randdir()
	if rnd()<0.5 then
		return left
	end
	return right
end

-- show sprite made of strings
function str_spr(str,sx,sy)
	for y,row in ipairs(str) do
		for x,col in ipairs(split(row,"")) do
			if col~=1 then
				pset(sx+x-1,sy+y-1,col)
			end
		end
	end
end

-- wrap at edge of screen
function wrap(char)
	if char.x<-8 then
		char.x=127-8
	elseif char.x>127-8 then
		char.x=-8
	end
end

-------------------------------
-- pico-8 callbacks
-------------------------------

-- pico-8 _init
function _init()
	poke(0x5f2d, 0x1)
	palt(0,false)
	palt(1,true)
	change_mode('menu')
end

-->8
-- modes

-------------------------------
-- menu
-------------------------------

menu_mode={
	selected=1,
	items={
		{text='game start',mode='play'},
		{text='balloon trip',mode='trip'}
	},
 balloon={
  '11999999999991111199999999999111119911111199111111999999999991111199999999999111119991111111911',
  '19999999999779111999999999977911199791111997911119999999999779111999999999977911199779111119791',
  '99999999999997919999999999999791999791119997911199999999999997919999999999999791999997911119979',
  '99999119999997919999911999999791999991119999911199999119999997919999911999999791999997911119979',
  '99991111999999919999111199999991999991119999911199991111999999919999111199999991999999991199999',
  '99991111999999919999111199999991999991119999911199991111999999919999111199999991999999999999999',
  '99999119999999119999911999999991999991119999911199999119999999919999911999999991999999999999999',
  '99999999999991119999999999999991999991119999911199999999999999919999999999999991999999999999999',
  '99999999999979119999999999999991999991119999911199999999999999919999999999999991999999999999999',
  '99999119999997919999911999999991999991119999911199999999999999919999999999999991999999999999999',
  '99991111999997919999111199999991999991119999911199999999999999919999999999999991999991199999999',
  '99991111999999919999111199999991999991119999911199999999999999919999999999999991999911119999999',
  '99999119999999919999111199999991999979119999791199999999999999919999999999999991999911119999999',
  '99999999999999919999111199999991999997919999979199999999999999919999999999999991999911119999999',
  '19999999999999111999111119999911199999911999999119999999999999111999999999999911199911111999991',
  '11999999999991111191111111999111119999111199991111999999999991111199999999999111119111111199911',
 },
 fight={
  '11999999999991111177111111999999999991111191111111999111119999999999911',
  '19999999999779111999711119999999999779111979111119977911199999999997791',
  '99999999999997919999711199999999999997919979111199999791999999999999979',
  '99999999999999119999911199999119999997919999111199999791199999999999991',
  '99999999999991119999911199991111199999119999911999999991119999999999911',
  '99999991111111119999911199991111111991119999999999999991111199999911111',
  '99999911111111119999911199991111111111119999999999999991111199999911111',
  '99999911111111119999911199991111111111119999999999999991111199999911111',
  '99999999999999119999911199991999999991119999999999999991111199999911111',
  '99999999999977919999911199991999999779119999999999999991111199999911111',
  '99999999999999119999911199991199999997919999999999999991111199999911111',
  '99999911111111119999911199991111999997919999911999999991111199999911111',
  '99999911111111119999911199991111999999919999111199999991111199999911111',
  '99999911111111119999911199999119999999919999111199999991111199999911111',
  '19999111111111111999911119999999199999111999111119999911111119999111111',
  '11991111111111111199111111999991119991111191111111999111111111991111111'
	}
}

function menu_mode:init()
	_draw=self.draw
	_update=self.update
end

function menu_mode:draw()
	self=self or menu_mode
	cls(0)
	local start_y=16
	local x=0
	local y=16
	str_spr(self.balloon,16,start_y)
	str_spr(self.fight,40,start_y+17)
	for i,item in ipairs(self.items) do
		local y=(i-1)*10+start_y+50
		if self.selected==i then
			rectfill(16,y-2,112,y+6,8)
		end
		printc(item.text,y,nil,nil,7)
	end	
end

function menu_mode:update()
	self=self or menu_mode
	if btnp(⬆️) then
		self.selected-=1
	end
	if btnp(⬇️) then
		self.selected+=1
	end
	self.selected=mid(1,self.selected,2)
	if btnp(4) or btnp(5) then
		local item=self.items[self.selected]
		change_mode(item.mode)		
	end
end

-------------------------------
-- play
-------------------------------

play_mode={}

function play_mode:init()
 bgstars:init()
 level:get()
 player.x=8
 player.y=90
 player.balloons=2
	_update=self.update
	_draw=self.draw
end

function play_mode:update()
	ticks=ticks+1
 bgstars:update()
 enemies:update()
 player:update()
 debug:update()
end

function play_mode:draw()
 cls(1)
 bgstars:draw()
 level:draw_bg()
 osd:draw()
 enemies:draw()
 player:draw()
 level:draw_fg()
	debug:draw()
end

-------------------------------
-- bonus
-------------------------------

bonus_mode={
	balloons={},
	balloon_max=20,
	delay=30,
	pipes={
		{col=2,row=13},
		{col=5,row=12},
		{col=10,row=14},
		{col=13,row=13}
	}
}

function bonus_mode:init()
	self.timer=0
	self.counter=0
	self.collected=0
	bgstars:init()
	level:get(0)
	player.balloons=2
	player.x=56
	player.y=127
	_update=self.update
	_draw=self.draw
end

function bonus_mode:draw()
	self=self or bonus_mode
 cls(1)
 bgstars:draw()
	for ball in all(self.balloons) do
		spr(30,ball.x,ball.y)
	end
 level:draw()
 osd:draw()
 player:draw()
	debug:draw()
end

function bonus_mode:new_balloon()
	local n=flr(rnd(4))+1
	local pipe=self.pipes[n]
	local anchor_x=pipe.col*8
	balloon={
		anchor_x=anchor_x,
		x=anchor_x,
		y=pipe.row*8,
		sine=0
	}
	add(self.balloons,balloon)
	self.counter+=1
end

function bonus_mode:update()
	self=self or bonus_mode
	ticks=ticks+1
	self.timer+=1
	if self.timer>self.delay then
		if self.counter>
				self.balloon_max then
			if count(self.balloons)==0 then
				change_mode('tally')
			end
		else
			self:new_balloon()
		end
		self.timer=0
	end
 bgstars:update()
 for ball in all(self.balloons) do
		ball.y-=1
		ball.sine+=0.01
		ball.x=ball.anchor_x+sin(ball.sine)*5
		ball.body={
			y=ball.y,
			x=ball.x,
			width=8,
			height=8
		}
		if ball.y<-8 then
			del(self.balloons,ball)
		end
		if collision(player.body,
				ball.body) then
			self.collected+=1
			del(self.balloons,ball)
		end
	end
 player:update()
 debug:update()
end

-------------------------------
-- tally
-------------------------------

tally_mode={
	step=20,
	value=300,
	super=10000
}

function tally_mode:init()
	self.timer=0
	self.state=1
	self.total=0
	self.state='init'
	if bonus_mode.collected then
		self.total=bonus_mode.collected*self.value
	end
	_draw=self.draw
	_update=self.update
end

function tally_mode:draw()
	self=self or tally_mode
	cls(1)
	osd:draw()
	local x=8
	local y=40
	spr(96,x,y,2,2,true)
	if self.timer<=self.step*2 then
		spr(30,x+20,y+4)
	else
		print('300',x+20,y+6)
	end
	local text=''
	if self.timer>self.step then
		text..='x '..tostr(bonus_mode.collected)
	end
	if self.timer>self.step*2 then
		text..=' = '..tostr(self.total)..' pts.'
	end
	if self.timer>self.step*3 then
		printc('p e r f e c t !!!',y+40,nil,nil,9)
		printc('super bonus  '..self.super..'pts!',y+50,nil,nil,9)
	end
	print(text,x+36,y+6,7)
end

function tally_mode:update()
	self=self or tally_mode
	if self.timer==self.step*2 then

	end
	if self.timer==self.step*3 then
		if bonus_mode.collected==bonus_mode.balloon_max then
			--sfx
			player.score+=self.super
		end
	end
	if self.state=='init' then
		self.timer+=1
		if self.timer>self.step*4 then
			self.state='countdown'
		end
	elseif self.state=='countdown' then
		if self.total<=0 then
			self.state='complete'
		else
			player.score+=100
			self.total-=100
		end
	else
		self.timer+=1
		if self.timer>self.step*5 then
			level:get(level.current+1)
			change_mode('play')
		end
	end
end

-------------------------------
-- trip
-------------------------------

-------------------------------
-- modes references
-------------------------------

modes={
	menu=menu_mode,
	play=play_mode,
	bonus=bonus_mode,
	tally=tally_mode,
	trip=trip_mode
}

-->8
-- player

player={
 x=0,
 y=0,
 width=16,
 height=16,
 anim=1,
 balloons=1,
 ball_anim=1,
 direction=right,
 lives=2,
 score=0,
 sprites={
 	floating=2,
  flapping={4,6,4,8},
  standing={34,36,34,38},
  running={40,42,40,44},
  dying={10,12,14,12}
 },
 vel={x=0,y=0},
 body={
 	x=0,y=0,width=8,height=16
 },
 ball_body={
		x=0,y=0,width=8,height=8
 },
 foot_body={
		x=0,y=0,width=8,height=8
 }
}


-- process animation
function player:animate()
 
 if ticks%3==0 then
  self.anim+=1
  if self.anim>4 then
   self.anim=1
  end
 end
 
 if ticks%30==0 then
  self.ball_anim+=1
  if self.ball_anim>4 then
   self.ball_anim=1
  end
 end
 
 -- if we're dead
 if self.balloons==0 then
 	self.sprite=self.sprites.dying[self.anim]

	-- if we're not dead
	else
	 -- if on ground
	 if self.grounded then
	 	-- running
	 	if input.x~=0 then
				self.sprite=self.sprites.running[self.anim] 		
			-- standing still
	 	else
				self.sprite=self.sprites.standing[self.ball_anim]
	 	end
	 -- if flapping
	 elseif input.b4 or input.b5 then
			self.sprite=self.sprites.flapping[self.anim]
		--	if floating
		else
			self.sprite=self.sprites.floating
	 end
	 -- if we have 2 balloons
	 if self.balloons==2 then
			self.sprite=self.sprite+62
	 end
	 
	end
	 
end
 

-- draw player
function player:draw()
 local flip_x=false
 if self.direction==right then
  flip_x=true
 end
 spr(
 		self.sprite,
 		self.x,
 		self.y,
 		2,
 		2,
 		flip_x
	)
	debug:draw_body(self.body,10)
	debug:draw_body(self.ball_body,12)
	debug:draw_body(self.foot_body,8)
end


-- update player movement
function player:update()

 -- add gravity
	self.vel.y+=gravity
 
	-- if we're dead
 if self.balloons==0 then
		-- *** maybe go up first
 	self.y+=self.vel.y
  
	-- if we're still alive
 else
	 
	 -- get input from player
	 input:get()
	
	 -- set facing direction
	 if input.x<0 then
	 	self.direction=left
	 elseif input.x>0 then
	 	self.direction=right
	 end
	 
		-- propulsion (lift)
	 if input.b4 or input.b5 then
			self.vel.y-=force
			self.grounded=false
		end
	 
	 -- move while grounded
	 if self.grounded then
	 	if input.x==0 then
		 	self.vel.x=lerp(
		 			0,self.vel.x,0.5)
		 else
		 	self.vel.x+=input.x
		 			*gspeed
	 		self.vel.x=mid(
	 				-gspeed_max,
	 				self.vel.x,
	 				gspeed_max)
	 	end
	 	
		-- air move when flapping
	 else
	 	if input.b4 or input.b5 then
	 		self.vel.x+=input.x
	 				*aspeed
	 		self.vel.x=mid(
	 				-aspeed_max,
	 				self.vel.x,
	 				aspeed_max)
	 	end
	 	
	 end
	 
		local test_body={}
		test_body.width=self.body.width
		test_body.height=self.body.height
	 
	 -- y collisions (level) first
		test_body.x=self.body.x
		test_body.y=self.body.y
	 test_body.y+=self.vel.y
		local v_coll=level:collision(test_body)
		if v_coll then
			if self.vel.y<0 then
				self.vel.y=bounce(self.vel.y)
			elseif self.vel.y>0 then
				self.grounded=true
				self.vel.y=0
				self.y=v_coll.y-16
			end
		else
			self.grounded=false
		end
		
		-- are too high on screen?
	 if self.y<0 and
	 		self.vel.y<0 then
			self.vel.y=bounce(self.vel.y)
	 end
		
		-- check x collisions (level)
		test_body.x=self.body.x
		test_body.y=self.body.y
		test_body.x+=self.vel.x
		local h_coll=level:collision(test_body)
		if h_coll then
			self.vel.x=0
		end
								
		-- move for real		
		self.y+=self.vel.y
		self.x+=self.vel.x
		
		-- wrap at edges
		wrap(self)
		 
		-- update body position
		self.body.x=self.x+3
		if self.direction==right then
			self.body.x+=1
		end
		self.body.y=self.y
		
		-- update ball_body position
		self.ball_body.x=self.body.x
		self.ball_body.y=self.body.y
		
		-- update foot_body position
		self.foot_body.x=self.body.x
		self.foot_body.y=self.body.y+8
		
	end
	
	-- pick appropriate sprite	
	self:animate()

end


-->8

-- enemies

enemies={}

-- create new enemy
function enemies:new(x,y)


	-- instance
	local dir=randdir()
	local enemy={
		x=x,
		y=y,
		dir=dir,
		pump=1,
		balloon=false,
		grounded=true,
		timer=0,
		anim={
			move=1,
			para=1,
			pump=1
		},
		ball_body={
			x=x,
			y=y,
			width=8,
			height=8
		},
		foot_body={
			x=x,
			y=y+8,
			width=8,
			height=8
		},
		body={
			x=x,
			y=y,
			width=8,
			height=16
		},
		vel={
			x=dir*rnd()+0.25,
			y=-1*rnd()+0.25
		},
		sprite=72,
		sprites={
			ball={226,227,242},
			dead=224,
			fall={202,204,206},
			flying={196,198,200,198},
			pump={192,194},
		}
	}
	
	
	-- animate one enemy
	function enemy:animate()
	
		-- animation if dead
		if self.dead then
			self.sprite=self.sprites.dead
		
		-- animation if grounded
		elseif self.grounded then
			if ticks%3==0 then
				self.anim.pump+=1
				if self.anim.pump>2 then
					self.anim.pump=1
				end
			end
			self.sprite=self.sprites.pump[self.anim.pump]
			
		-- animation if flying
		elseif self.balloon then
			-- movement animation
			if ticks%3==0 then
				self.anim.move+=1
				if self.anim.move>4 then
					self.anim.move=1
				end
			end
			if self.vel.y>0 then
				self.sprite=self.sprites.flying[1]
			else
				self.sprite=self.sprites.flying[self.anim.move]
			end

		-- animation if falling
		else
			if ticks%5==0 then
				if self.anim.para<3 then
					self.anim.para+=1
				end
			end
			self.sprite=self.sprites.fall[self.anim.para]

		end
		
	end
	
	
	-- draw one enemy
	function enemy:draw()
		
		if self.grounded and
				not self.dead then
			spr(
				self.sprites.ball[self.pump],
				self.x-4,
				self.y+10
			)
		end
		
		local flip_x=false
		if self.dir==right and
				self.balloon then
			flip_x=true
		end
		spr(
				self.sprite,
				self.x,
				self.y,
				2,
				2,
				flip_x
		)

		debug:draw_body(self.body,10)
		debug:draw_body(self.ball_body,12)
		debug:draw_body(self.foot_body,8)
	
	end
	
	
	-- update one enemy
	function enemy:update()
	
		-- if we're dead
		if self.dead then
			self.y+=2

		-- if we're grounded
		elseif self.grounded then

			if not self.balloon then
				if ticks%30==0 then
					if self.pump<3 then
						self.pump+=1
					else
						self.grounded=false
						self.balloon=true
						self.pump=1
					end
				end
			end
			
			if collision(self.body,
					player.body) then
				self.dead=true
			end
			
		-- if not dead nor grounded
		else
			
			-- are too high on screen?
		 if self.y<0 then
		 	self.vel.y=-self.vel.y
		 -- are we too low
		 elseif not self.balloon and
		 		self.y>120 then
		 		self.vel.y=-self.vel.y
		 end		
		 
	 	-- movement test body
			local test_body={}
			test_body.width=self.body.width
			test_body.height=self.body.height
		
			-- level collisions (y)
			test_body.x=self.body.x
			test_body.y=self.body.y
		 test_body.y+=self.vel.y
			local v_coll=level:collision(test_body)
			if v_coll then
				if self.balloon then
					self.vel.y=-self.vel.y
				else
					self.grounded=true
				end
			end
			
			-- level collisions (x)
			test_body.x=self.body.x
			test_body.y=self.body.y
			test_body.x+=self.vel.x
			local h_coll=level:collision(test_body)
			if h_coll then
				self.vel.x=-self.vel.x
			end
			
			-- player collision(s)
			if collision(self.ball_body,
					player.foot_body) and 
					self.balloon then
				if self.balloon then
					self.balloon=false
					self.anim.para=1
					self.vel.y=0.5
				else
					self.dead=true
				end
				player.vel.y=-1
				player.vel.x=-player.vel.x
			elseif collision(
					self.foot_body,
					player.ball_body) and
					self.balloon then
				player.balloons-=1
			elseif collision(
					self.body,
					player.body) then
				player.vel.x=-player.vel.x
				self.vel.x=-self.vel.x
			end

			-- move for real		
			self.y+=self.vel.y
			self.x+=self.vel.x

			-- wrap at edges
			wrap(self)
	
			-- facing direction
			if self.vel.x<0 then
				self.dir=left
			elseif self.vel.x>0 then
				self.dir=right
			end

		end
		
				-- update body position
		self.body.x=self.x+3
		if self.direction==right then
			self.body.x+=1
		end
		self.body.y=self.y
		self.ball_body.x=self.body.x
		self.ball_body.y=self.body.y
		self.foot_body.x=self.body.x
		self.foot_body.y=self.body.y+8
		
		-- animate/pick sprite
		self:animate()
		
	end


	-- add instance to table
	add(self,enemy)


end


-- draw all enemies
function enemies:draw()
	for enemy in all(self) do
		enemy:draw()
	end
end


-- update all enemies
function enemies:update()
	for enemy in all(self) do
		enemy:update()
		if enemy.dead and enemy.y>127 then
			del(self,enemy)
		end
	end
end


-->8
-- misc

-------------------------------
-- bgstars
-------------------------------

bgstars={}

function bgstars:init()
 for i=1,25 do
  local bgstar={
   x=flr(rnd(128)),
   y=flr(rnd(128))
  }
  add(self,bgstar)
 end
end
 
function bgstars:update()
 for bgstar in all(self) do
  if flr(rnd(100)) == 0 then
   bgstar.x=flr(rnd(128))
   bgstar.y=flr(rnd(128))
  end
 end
end
 
function bgstars:draw()
 for bgstar in all(self) do
  pset(bgstar.x,bgstar.y,13) 
 end
end

-------------------------------
-- input
-------------------------------

input={}

function input:get()
 self.x=0
 self.y=0
 self.b=false
 if btn(⬅️) and btn(➡️)==false then
  self.x=-1
 elseif btn(➡️) and btn(⬅️)==false then
  self.x=1
 else
  self.x=0
 end
 self.b4=btn(4,0)
 self.b5=btn(5,0)
end

-------------------------------
-- level
-------------------------------

level={
	current=1,
	celx=0,
	cely=0
}

-- draw level bg
function level:draw_bg()
 map(
 	self.celx,
 	self.cely,
 	0,
 	0,
 	16,
 	16,
 	f_bg+1
 )
end

-- draw level fg
function level:draw_fg()
 map(
 	self.celx,
 	self.cely,
 	0,
 	0,
 	16,
 	16,
 	f_fg+1
 )
end
 
-- load level
function level:get(n)
	self.current=n or self.current
	self.celx=self.current%10*16
	self.cely=flr(self.current/10)*16
	for x=0,15 do
		for y=0,15 do
			local sprite=mget(
					self.celx+x,
					self.cely+y
			)
			local flag=fget(sprite,f_enemy)
			if flag then
				enemies:new(x*8,y*8)
			end
		end
	end
end

-- check collision
function level:collision(rect1)
	for x=0,15 do
		for y=0,15 do
			local sprite=mget(
					self.celx+x,
					self.cely+y	
			)
			local flag=fget(sprite,f_solid)
			local rect2={
				x=x*8,y=y*8,width=8,height=8
			}
			if flag and collision(rect1,rect2) then
				return rect2
			end
		end
	end
	return false
end

-------------------------------
-- osd
-------------------------------

osd={}

function osd:draw()

	-- score
	print('i-',8,2,8)
	print(pad(player.score,6),16,2,7)

	-- lives
	if player.lives>0 then
		local x=56
		spr(13+player.lives,x,0)
	end

	-- top
	print('top-',79,2,9)
	print('000000',95,2,7)

end

-->8
-- debug

debug={
	on=true,
	visuals=false
}

function debug:draw_body(body,c)
	if self.on and self.visuals then
		rect(
			body.x,
			body.y,
			body.x+body.width,
			body.y+body.height,
			c
		)
	end
end

function debug:draw()
	if self.on then
		print(self.message,0,8,7)
	end
end

function debug:input()
	if self.on then
		local key=stat(31)
		if key=='`' then
			self.visuals=not self.visuals
		end
		if key=='b' then
			player.balloons+=1
			if player.balloons>2 then
				player.balloons=1
			end
		end
		if key=='d' then
			player.balloons=0
		end
		if key=='e' then
			enemies:new(64,64)
		end
		if key=='l' then
			player.lives+=1
			if player.lives>2 then
				player.lives=0
			end
		end
		if key=='f' then
			balloons:new()
		end
		if key=='s' then
			player.score+=1
		end
	end
end

function debug:update()
	--[[
	self.messages={
		'grnd:'..(player.grounded and '1' or '0'),
		'vely:'..player.vel.y,
		'velx:'..player.vel.x
	}
	self:input()
	]]
	self:input()
end
__gfx__
00000000111111111111108801111111111110880111111111111088011111111111108801111111111111111111111111111111111111111111111111111111
00000000111111111111088780111111111108878011111111110887801111111111088780111111111111111111111111111111111111111111111111111111
00000000111111111110888878011111111088887801111111108888780111111110888878011111111111111111111111111111111111111111111111111111
00000000111111111110888888011111111088888801111111108888880111111110888888011111111110ccc0111111111110ccc0111111111110ccc0111111
00000000111111111111088880111111111108888011111111110888801111111111088880111111110f0cfffc0f011111110cfffc01111111110cfffc011111
0000000011111111111110880111111111111088011111111111108801111111111110880111111110ff0cfffc0ff01111110cfffc01111111110cfffc011111
000000001111111111111070111111111111107011111111111110701111111111111070111111111110c0fff0c01111111110fff0111111111110fff0111111
000000001111111111110ccc0111111111110ccc0111111111110ccc00f0111111110ccc0111111111110c888c01111110ffcc888ccff01111110c888c011111
111111111111111111110ffcc011111111110ffcc011111111110ffcc0ff011111110ffcc01111111111088788011111110f0887880f01111110c88788c01111
11111111111111111110fffcc01111111110fffcc0ff01111110fffcc0c011111110fffcc0111111111108888801111111110888880111111110ff888ff01111
111111111111111111110ffc0111111111110ffc8ccf011111110ffc8c01111111110ffc880111111110c88088c011111110c88088c011111110f88088f01111
11111111111111111110f188c011111111111087880111111111108788011111111110878c01111111110c010c01111111110c010c01111111110c010c011111
111111111111111111110878fc011111111111088801111111111108880111111111110888cf0111111111111111111111111111111111111111111111111111
1111111111111111110c8888ff011111111110cc80111111111110cc80111111111110cc80ff0111111111111111111111111111111111111111111111111111
11111111111111111110c80111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111108801111111111111111111111111111111111111111111111108801111111111110880111111111111088011111111111111111111
11111111111111111111088780111111111110880111111111111088011111111111111088780111111111108878011111111110887801111118711118711871
11111111111111111110888878011111111108878011111111110887801111111111110888878011111111088887801111111108888780111118811118811881
11111111111111111110888888011111111088887801111111108888780111111111110888888011111111088888801111111108888880111111711111711171
11111111111111111111088880111111111088888801111111108888880111111111111088880111111111108888011111111110888801111117111117111711
11111111111111111111108801111111111108888011111111110888801111111111111108801111111111110880111111111111088011111111111111111111
1111111111111111111110ccc0111111111110ccc0111111111110ccc01111111110ccc0070111111110ccc0070111111110ccc0070111111111111111111111
1111111111111111111110ffcc011111111110ffcc011111111110ffcc0111111110ffcc701111111110ffcc701111111110ffcc70111111110bb01111088011
111111111111111111110fffcc01111111110fffcc01111111110fffcc011111110fffcc01111111110fffcc01111111110fffcc0111111110bb7b0110887801
1111111111111111111110ffc0111111111110ffc0111111111110ffc01111111110ffc0111111111110ffc0cf0111111110ffc0111111110bbbb7b008888780
111111111111111111110c888c01111111110c888c01111111110c888c0111111111088c011111111110c88cff011111110ff8c8011111110bbbbbb008888880
11111111111111111110fc878fc011111110fc878fc011111110fc878fc01111111088fc01111111110f888011111111110ffc880111111110bbbb0110888801
11111111111111111110f8888ff011111110f8888ff011111110f8888ff01111110f88ff0111111110c888880111111111108888c0111111110bb01111088011
1111111111111111111108808801111111110880880111111111088088011111110cc08801111111110c0088c0111111111108088c0111111110701111107011
11111111111111111110cc010cc011111110cc010cc011111110cc010cc0111111110cc0111111111111110cc01111111110cc01111111111107011111070111
11111088008801111111108800880111111110880088011111111088008801111111111111111111111111111111111111111111111111111111111111111111
11110887828780111111088782878011111108878287801111110887828780111111111111111111111111111111111111111111111111111111111111111111
11108888782878011110888878287801111088887828780111108888782878011111111111111111111111111111111111111111111111111111111111111111
11108888882888011110888888288801111088888828880111108888882888011111111111111111111111111111111111111111111111111111111111111111
11110888828880111111088882888011111108888288801111110888828880111111111111111111111111111111111111111111111111111111111111111111
11111088008801111111108800880111111110880088011111111088008801111111111111111111111111111111111111111111111111111111111111111111
11111070070111111111107007011111111110700701111111111070070111111111111111111111111111111111111111111111111111111111111111111111
11110ccc7011111111110ccc7011111111110ccc70f0111111110ccc701111111111111111111111111111111111111111111111111111111111111111111111
11110ffcc011111111110ffcc011111111110ffcc0ff011111110ffcc01111111111111111111111111111111111111111111111111111111111111111111111
1110fffcc01111111110fffcc0ff01111110fffcc0c011111110fffcc01111111111111111111111111111111111111111111111111111111111111111111111
11110ffc0111111111110ffc8ccf011111110ffc8c01111111110ffc880111111111111111111111111111111111111111111111111111111111111111111111
1110f088c011111111111087880111111111108788011111111110878c0111111111111111111111111111111111111111111111111111111111111111111111
11110878fc011111111111088801111111111108880111111111110888cf01111111111111111111111111111111111111111111111111111111111111111111
110c8888ff011111111110cc80111111111110cc80111111111110cc80ff01111111111111111111111111111111111111111111111111111111111111111111
1110c801111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11110880088011111111088011111111111111110880111111111088008801111111108800880111111110880088011111111111111111111111111111111111
111088782878011111108878288011111111088088f801111111088f828f80111111088f828f80111111088f828f801111111111111111111111111111111111
11088887828780111108888782780111111088f8288f801111108888f828f80111108888f828f80111108888f828f80111111111111111111111111111111111
110888888288801111088888828780111108888f8288801111108888882888011110888888288801111088888828880111111111111111111111111111111111
11108888288801111110888828888011110888888288011111110888828880111111088882888011111108888288801111111111111111111111111111111111
11110880088011111111088088880111111088882880111111111088008801111111108800880111111110880088011111111111111111111111111111111111
1111107ccc7011111111107ccc8011111111088ccc01111111110ccc0070111111110ccc0070111111110ccc0070111111111111111111111111111111111111
1111110ffcc011111111110ffcc011111111110ffcc0111111110ffcc701111111110ffcc701111111110ffcc701111111111111111111111111111111111111
111110fffcc01111111110fffcc01111111110fffcc011111110fffcc01111111110fffcc01111111110fffcc011111111111111111111111111111111111111
1111110ffc0111111111110ffc0111111111110ffc01111111110ffc0111111111110ffc0cf0111111110ffc0111111111111111111111111111111111111111
111110c888c01111111110c888c01111111110c888c0111111111088c011111111110c88cff011111110ff8c8011111111111111111111111111111111111111
11110fc878fc011111110fc878fc011111110fc878fc01111111088fc01111111110f888011111111110ffc88011111111111111111111111111111111111111
11110f8888ff011111110f8888ff011111110f8888ff01111110f88ff0111111110c888880111111111108888c01111111111111111111111111111111111111
1111108808801111111110880880111111111088088011111110cc08801111111110c0088c0111111111108088c0111111111111111111111111111111111111
11110cc010cc011111110cc010cc011111110cc010cc0111111110cc0111111111111110cc01111111110cc01111111111111111111111111111111111111111
11033b3333b33b3333b3301111111111065556701065670111111111111111111111111111111111111111111111111111111111111111111111111111111111
103bbb3bb33bbb3bb33bbb0111111111065556701065670111766711766711111111111111111111111111111111111111111111111111111111111111111111
0bb3bbbbbbb3bbbbbbb3bbb011111111065556701065670117666677666671111111111111111111111111111111111111111111111111111111111111111111
03444b3443444b3443444b3011111111065556701065670117666666666671111111111111111111111111111111111111111111111111111111111111111111
c76677ccc76677ccc76677ccc76677cc106567011065670117666666666666711111111111111111111111111111111111111111111111111111111111111111
76cc667776cc667776cc667776cc6677106567011065670176666666666666671111111111111111111111111111111111111111111111111111111111111111
6ccccc666ccccc666ccccc666ccccc66106567011065670176666666666666671111111111111111111111111111111111111111111111111111111111111111
cccccccccccccccccccccccccccccccc106567011065670176666666666666671111111111111111111111111111111111111111111111111111111111111111
03b33b3333b33b3333b33b3011111111104444011044440176666666666666671111111111111111111111111111111111111111111111111111111111111111
033bbb3bb33bbb3bb33bbb3011111111049999400499994076666666666666671111111111111111111111111111111111111111111111111111111111111111
0bb3bbbbbbb3bbbbbbb3bbb011111111049999400499994017666666666666711111111111111111111111111111111111111111111111111111111111111111
03444b3443444b3443444b3011111111049999400499994011176666666666711111111111111111111111111111111111111111111111111111111111111111
04999449949994499499944011111111049999401049940111176666776666711111111111111111111111111111111111111111111111111111111111111111
04999999999999999999940111111111049999401049940111117667117667111111111111111111111111111111111111111111111111111111111111111111
10499999999999999999401111111111049999401104401111111111111111111111111111111111111111111111111111111111111111111111111111111111
11044444444444444444011111111111104444011104401111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111110ee01111111111110ee01111111111110ee011111111111111111111111111111108c8011111111108cc8011111
1111111111111111111111111111111111110ee7e011111111110ee7e011111111110ee7e0111111111111111111111111111108c8c80111111088c88c880111
111111111111111111111111111111111110eeee7e0111111110eeee7e0111111110eeee7e011111111111111111111111111088c8c80111110888c88c888011
111111111111111111111111111111111110eeeeee0111111110eeeeee0111111110eeeeee01111111111111111111111111108c888c801110888c8888c88801
1111111111111111111111111111111111110eeee011111111110eeee011111111110eeee0111111111111108c8801111111108c888c880110888c8888c88801
11111111111111111111111020111111111110ee01111111111110ee01111111111110ee01111111111110888c8c8011111111088888c80108800c8888c00880
111111102011111111110444201111111111107020111111111110702011111111111070201111111111108088c801111111111108c8c8010807000880007080
11110444201111111110e74440111111111104442040111111110444201111111111044420111111111111020070111111111102007088011110700201070111
1110e744401111111044444ee01111111110e744404401111110e744401111111110e74440111111111104420701111111110442070111111110044200701111
1044444ee011111111110eee220111111044444ee0e011111044444ee04401111044444ee01111111110e744422011111110e744422011111110e74442201111
11110eee2201111111111022e220111111110eee2e01111111110eee2ee4011111110eee220111111044444ee22201111044444ee22201111044444ee2220111
11111022e22011111111044e2220111111111022220111111111102222011111111110222e01111110400eee2222201110400eee2222201110400eee22222011
1111110e222011111111040222201111111111022201111111111102220111111111110222e4011111111022ee22201111111022ee22201111111022ee222011
111110442220111111110702222011111111104420111111111110442011111111111044204401111111110ee22420111111110ee22420111111110ee2242011
11110700220111111111070024011111111111111111111111111111111111111111111111111111111111044004401111111104400440111111110440044011
11110550440111111111055004011111111111111111111111111111111111111111111111111111111111040110401111111104011040111111110401104011
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111111111111111111110ee011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1111104011111111110e701110ee7e01111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111044e4011111110ee01110eeee01111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111047440201111111111110ee011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1104010e442201111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11042202ee4011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11042222220111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11102222ee011111110ee01111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111110222ee4011110ee7e0111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111102204401110eeee7e011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111110eeeeee011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111111111110eeee0111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1111111111111111110ee01111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060601010101000000000000000006060606060601010000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009092000000000000009091920000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000094000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000008687000000000000000000000000000000000091919191000000000000000000000000000095000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000009697000000000000009191919191000000000000000000000000000000000090919200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000868700000000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000969700000000000000000000950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000c0c100c0c100c0c100000000868700000000000000000000000000000000909192000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000d0d100d0d100d0d100000000969700000000000000000000000000000000009400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000909191919191919200000000000000009091919191919192000000000000009500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000090919200000000000000000000008400000000000000000000000000000084000000000000000000000000000000840000000000000000000000000000008400000000000000000000
0000840000850000000000000084000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008400008500000000000000840000000084000085000000000000008400000000840000850000000000000084000000008400008500000000000000840000
0000850000850000000084000085000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008500008500000000840000850000000085000085000000008400008500000000850000850000000084000085000000008500008500000000840000850000
9191919191919191919191919191919181818182838383838383838380818181818181828383838383838383808181818181818283838383838383838081818191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000084000000000000000000000000000000840000000000000000000000000000008400000000000000000000000000000084000000000000000000000000000000840000000000000000000000000000008400000000000000000000
0000000000000000000000000000000000000000000000000000000000840000000084000085000000000000008400000000840000850000000000000084000000008400008500000000000000840000000084000085000000000000008400000000840000850000000000000084000000008400008500000000000000840000
0000000000000000000000000000000000000000000000000000000000850000000085000085000000008400008500000000850000850000000084000085000000008500008500000000840000850000000085000085000000008400008500000000850000850000000084000085000000008500008500000000840000850000
9191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191919191
